(()=>{var __webpack_modules__={943:(e,n,t)=>{const r=t(195);e.exports=async({helpers:e,render:n})=>{const t=await n.getContent({});const r=await generate(e.octokit,t,n.filesSpec);return{code:r}};function parseMarkdown(e,n){const t=e.replace(/\r/g,"");const{frontmatter:r,markdown:o}=splitMarkdown(t);const a=parseFrontmatterConfig(r);const s=discoverMarkdownChunks(o,n);return{config:a,chunks:s}}function splitMarkdown(e){const n=e.match(/^---\n(.*)---/ms);if(n&&n.length===2)return{frontmatter:n[1],markdown:e.slice(n[0].length+n.index)};return{frontmatter:undefined,markdown:e}}function parseFrontmatterConfig(e){return e?r.load(e):{}}function discoverMarkdownChunks(e,n){const t=[...e.matchAll(/```{([\w# ]+)(?:\((.*?)\))?}(?:\s*?\[([\w\/]+)(?:\((.*?)\))?\])?(.*?)```/gms)];let r=0;const o=[];for(const n of t){const t=e.slice(r,n.index).trim();if(t)o.push({type:"md",content:t});const[a,s]=n[1].split("#");const i=n[2]?n[2].split(",").map((e=>e.trim())):undefined;const c=n[3];const u=n[4]?n[4].split(",").map((e=>e.trim())):undefined;const m=n[5].trim();o.push({type:a,name:s,inputs:i,renderer:c,renderArgs:u,content:m});r=n.index+n[0].length}if(r!==e.length){const n=e.slice(r,e.length).trim();if(n)o.push({type:"md",content:n})}return o}async function generate(e,n,t,r){const{chunks:o}=parseMarkdown(n);const a=createState(e,t,r);const s=generateBody(o,a);const i=await generatePreamble(a);const c=generatePostamble();return[i,...s,c].filter(Boolean).map((e=>e.trim())).join("\n")}async function generatePreamble(e){const n=await captureImportedModules(e);return`\n// Imported modules\n${n.map((e=>e.code)).join("\n").trim()}\n\n// Transpiled user markdown to JavaScript\nexport${e.level?" ":" default "}function define${e.level}(runtime, observer) {\n  const main = runtime.module()\n${n.map((e=>e.unique)).map((e=>`  const child${e} = runtime.module(define${e})`)).join("\n")}\n`.trim()}function captureImportedModules(e){return Promise.all(e.modules.map((async n=>{const t=e.octokit.resolve(n.name,e.current);const r=await getModuleContent(t,e.octokit);const o=e.level+n.alias;const a=await generate(e.octokit,r,t,o);return{code:a.trim(),unique:o}})))}function getModuleContent(e,n){const t=n.repos.getContent(e);return Buffer.from(t.data.content,"base64").toString("utf8")}function generatePostamble(){return`\n  return main\n}`}function createState(e,n,t){return{octokit:e,current:n,modules:[],level:t||""}}const o={md:generateMarkdown,html:generateHTML,javascript:generateJavaScript,imports:generateImports};function generateBody(e,n){return e.reduce(((e,t)=>{const r=o[t.type];if(!r)throw new Error(`Unknown chunk type ${t.type}`);const a=r(t,n);if(Array.isArray(a))e.push(...a);else e.push(a);return e}),[])}function generateMarkdown(e,n){const t=["md",...e.inputs||[]];const r=e.name||"";return generateVariable(r,t,e.content,"md")}function generateHTML(e,n){const t=["html",...e.inputs||[]];const r=e.name||"";return generateVariable(r,t,e.content,"html")}function generateJavaScript(e,n){const{implicitInputs:t}=analyzeJS(e,n);const r=[...t,...e.inputs||[]];const o=e.name||"";const a=e.content.match(/(?:^|\s)+return(?:$|\s)+/);const s=e.content.match(/(?:^|[^\w])+await\s+/);const i=e.content.match(/(?:^|[^\w])+yield\s+/);const c={hasReturn:a,isAsync:s,isGenerator:i};return generateVariable(o,r,e.content,undefined,c,e.renderer,e.renderArgs)}function generateImports(e,n){const t=e.content.split("\n");return t.reduce(((e,t)=>{const r=parseImportLine(t);if(r.module){const{name:t,alias:o,module:a,isViewOf:s}=r;const i=getModuleEntry(a,n.modules);if(s)e.push(generateImport(t,o,i,true));e.push(generateImport(t,o,i))}else if(r.origin){const{owner:t,repo:o,ref:a}=n.current;const s=`https://github.com/${t}/${o}/blob/${a||"main"}/${r.origin.replace("./","")}?raw=true`;e.push(`\nmain.variable(observer("${r.alias}")).define("${r.alias}", [], function() { \n  return fetch("${s}")\n})`)}return e}),[])}function parseImportLine(e){const n=e.match(/{(.*?)}\s+from\s+(.*)/);if(n)return parseModuleImport(n);const t=e.match(/(.*?)\s+load\s+(.*)/);if(t)return parseLoadImport(t);throw new Error("missing import statements in import chunk")}function parseModuleImport(e){const n=e[1].match(/^\s?(viewof\s+)?(.+?)(?:(?:\s+as\s+(?:viewof\s+)?(\w+))|$)/);const t=!!n[1];const r=n[2].trim();const o=n[3]?n[3].trim():null;const a=e[2].trim();return{name:r,alias:o,module:a,isViewOf:t}}function parseLoadImport(e){const n=null;const t=e[1].trim();const r=e[2].trim();return{spec:n,alias:t,origin:r}}function getModuleEntry(e,n){const t=n.find((n=>n.name===e));if(t)return t;const r={name:e,alias:n.length.toString()};n.push(r);return r}function generateImport(e,n,t,r){const o=r?`viewof ${e}`:e;const a=n?r?`"viewof ${n}", `:`"${n}", `:"";return`\nmain.import("${o}", ${a}child${t.alias})`}function analyzeJS(e,n){return{implicitInputs:[]}}function generateVariable(e,n,t,r,o={},a,s){const i=generateWrappedCode(t,r,o,a,s);if(a&&!n.includes("render"))n=[...n,"render"];const c=n.map((e=>`"${e}"`)).join(", ");const u=n.map((e=>e.replace(/ /g,"_"))).join(", ");const m=e?`"${e}"`:"";const p=`${o.isAsync?"async ":""}function${o.isGenerator?"*":""}`;const l=!o.isViewOf&&o.isHidden?"":`observer(${m})`;const d=[`main.variable(${l}).define(${m}${e?", ":""}[${c}], ${p}(${u}) { ${i}})`];if(e&&o.isViewOf)d.push(generateViewValue(e,o.isHidden));return d}function generateWrappedCode(e,n,t,r,o){const a=n?`${n}\`${e.trim()}\``:e.trim();const s=t.hasReturn||t.isGenerator?`\n  ${a}\n`:`return (\n  ${a}\n)`;if(!r)return s;return`\n    const _content = (() => {\n      ${s}\n    })()\n    const _renderOptions = ${o}\n    return render(_content, "${r}", _renderOptions)\n`}function generateViewValue(e,n){const[t]=e.split(" ");const r=n?"":`observer("${t}")`;return`main.variable(${r}).define("${t}", ["Generators", "${e}"], (G, _) => G.input(_))`}},195:module=>{module.exports=eval("require")("js-yaml")}};var __webpack_module_cache__={};function __nccwpck_require__(e){var n=__webpack_module_cache__[e];if(n!==undefined){return n.exports}var t=__webpack_module_cache__[e]={exports:{}};var r=true;try{__webpack_modules__[e](t,t.exports,__nccwpck_require__);r=false}finally{if(r)delete __webpack_module_cache__[e]}return t.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__=__nccwpck_require__(943);module.exports=__webpack_exports__})();